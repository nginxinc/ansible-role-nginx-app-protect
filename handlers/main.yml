---
- name: (Handler) Check NGINX
  command: "nginx -t"
  changed_when: false

- name: (Handler) Run NGINX
  block:
    - name: (Handler) Start NGINX
      service:
        name: nginx
        state: started
        enabled: true
      notify: (Handler) Check NGINX

    - name: (Handler) Restart NGINX
      service:
        name: nginx
        state: restarted
      changed_when: false
  when:
    - nginx_app_protect_start | bool
    - not ansible_check_mode
